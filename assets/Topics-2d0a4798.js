import{_ as me,c as j,o as fe,a as c,b as V,e as l,w as o,u as t,i as F,r as m,E as _e,f as ve,d as s,M as ge,D as ye,J,N as we,y as U,l as h,t as p,I as he,F as B,m as I,O as N,V as xe,S as be,n as Ve,P as Ce,T as Te,q as Ee,s as ke,U as Ae,Q as Se,R as Ue,a0 as ze,a1 as Fe,Y as $e}from"./index-bc0a5eae.js";/* empty css                   *//* empty css                       */import{s as $}from"./request-cb2fba24.js";/* empty css                  *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css                     */import{c as Q,s as z}from"./message-4842d644.js";async function De(){return $({url:"/topics",method:"GET"})}async function Pe(C){return $({url:"/topics",method:"POST",data:C})}async function Re(C,_){return $({url:`/topics/${C}`,method:"PUT",data:_})}async function Y(C){return $({url:`/topics/${C}`,method:"DELETE"})}const Be={class:"topics-container"},Ie={class:"search-bar"},Ne={class:"button-group"},Oe=["onClick"],qe={class:"answer"},Le={class:"action-buttons"},Me={class:"explanation-content"},Ge={class:"explanation-item"},je={class:"explanation-text"},Je={class:"explanation-item"},Qe={class:"explanation-text"},Ye={key:0,class:"explanation-item"},He={class:"explanation-options"},Ke={class:"explanation-item"},We={class:"explanation-text answer-text"},Xe={class:"explanation-item"},Ze={class:"explanation-text"},et={class:"dialog-footer"},tt={class:"options-container"},lt={class:"option-letter"},at={class:"dialog-footer"},ot={__name:"Topics",setup(C){const _=m(!1),D=m("新建题目"),g=m(1),x=m(10),v=m(!1),b=m(null),A=m(!1),d=m({}),T=m([]),E=m({title:""}),i=m({id:"",title:"",type:"single-choice",options:["","","",""],correctAnswer:"",explanation:""}),H={title:[{required:!0,message:"请输入题目",trigger:"blur"}],type:[{required:!0,message:"请选择题目类型",trigger:"change"}],options:[{validator:(n,e,u)=>{i.value.type==="single-choice"&&e.some(y=>!y||y.trim()==="")?u(new Error("请填写所有选项")):u()},trigger:"blur"}],correctAnswer:[{required:!0,message:"请选择答案",trigger:"change"}]},S=m([]),O=j(()=>{let n=S.value||[];return E.value.title&&(n=n.filter(e=>{var u;return(u=e.title)==null?void 0:u.includes(E.value.title)})),n}),K=j(()=>{const n=(g.value-1)*x.value,e=n+x.value;return(O.value||[]).slice(n,e)}),P=async()=>{try{v.value=!0;const n=await De();console.log("获取到的题目数据:",n),S.value=n||[]}finally{v.value=!1}};fe(()=>{P()});const W=n=>{x.value=n,g.value=1},X=n=>{g.value=n},Z=()=>{g.value=1,console.log("搜索题目:",E.value)},ee=()=>{D.value="新建题目",i.value={id:"",title:"",type:"single-choice",options:["","","",""],correctAnswer:"",explanation:""},b.value&&b.value.clearValidate(),_.value=!0},te=n=>{D.value="编辑题目",i.value={id:n.id,title:n.title,type:n.type,options:n.type==="single-choice"?n.options||["","","",""]:[],correctAnswer:n.correctAnswer||"",explanation:n.explanation||""},b.value&&b.value.clearValidate(),_.value=!0},le=n=>{d.value=n,A.value=!0},ae=n=>{Q("确定要删除该题目吗？").then(async()=>{try{v.value=!0,await Y(n),await P(),z("删除成功")}finally{v.value=!1}}).catch(()=>{})},oe=n=>{T.value=n},ne=()=>{if(T.value.length===0){z("请先选择要删除的题目");return}Q(`确定要删除选中的 ${T.value.length} 道题目吗？`).then(async()=>{try{v.value=!0;const n=T.value.map(e=>Y(e.id));await Promise.all(n),z("批量删除成功"),T.value=[],await P()}finally{v.value=!1}}).catch(()=>{})},se=async()=>{b.value&&await b.value.validate(async n=>{if(n)try{if(v.value=!0,i.value.id){const e=await Re(i.value.id,i.value),u=S.value.findIndex(f=>f.id===i.value.id);u!==-1&&(S.value[u]=e),z("编辑成功")}else{const e=await Pe(i.value);S.value.unshift(e),z("创建成功")}_.value=!1}finally{v.value=!1}})};return(n,e)=>{const u=xe,f=be,y=Ve,w=Ce,q=Te,k=Ee,ie=ke,re=Ae,ue=_e,L=ve,M=Se,de=Ue,R=ze,G=Fe,pe=$e;return c(),V("div",Be,[l(ue,{shadow:"hover"},{header:o(()=>[...e[12]||(e[12]=[s("div",{class:"card-header"},[s("span",null,"题目管理")],-1)])]),default:o(()=>[s("div",Ie,[l(q,{inline:!0,model:t(E)},{default:o(()=>[l(f,{label:"题目"},{default:o(()=>[l(u,{modelValue:t(E).title,"onUpdate:modelValue":e[0]||(e[0]=a=>t(E).title=a),placeholder:"请输入题目",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),l(f,null,{default:o(()=>[l(w,{type:"success",onClick:Z},{default:o(()=>[l(y,null,{default:o(()=>[l(t(ge))]),_:1}),e[13]||(e[13]=s("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),s("div",Ne,[l(w,{type:"primary",onClick:ee},{default:o(()=>[l(y,null,{default:o(()=>[l(t(ye))]),_:1}),e[14]||(e[14]=s("span",null,"新建题目",-1))]),_:1}),l(w,{type:"danger",disabled:t(T).length===0,onClick:ne},{default:o(()=>[l(y,null,{default:o(()=>[l(t(J))]),_:1}),e[15]||(e[15]=s("span",null,"批量删除",-1))]),_:1},8,["disabled"])])]),we((c(),U(ie,{data:t(K),style:{width:"100%"},onSelectionChange:oe},{default:o(()=>[l(k,{type:"selection",width:"55",align:"center"}),l(k,{label:"编号",width:"90"},{default:o(a=>[h(p((t(g)-1)*t(x)+a.$index+1),1)]),_:1}),l(k,{prop:"title",label:"题目","min-width":"250","show-overflow-tooltip":""},{default:o(a=>[s("span",{class:"clickable-title",onClick:r=>le(a.row)},p(a.row.title),9,Oe)]),_:1}),l(k,{label:"题目类型",width:"120"},{default:o(a=>[h(p(a.row.type==="single-choice"?"单选题":a.row.type==="true-false"?"判断题":a.row.type),1)]),_:1}),l(k,{prop:"correctAnswer",label:"答案",width:"100",align:"center"},{default:o(a=>[s("span",qe,p(a.row.type==="true-false"?a.row.correctAnswer==="正确"?"正确":a.row.correctAnswer==="错误"?"错误":a.row.correctAnswer||"-":a.row.correctAnswer||"-"),1)]),_:1}),l(k,{label:"操作",width:"180",fixed:"right",align:"center"},{default:o(a=>[s("div",Le,[l(w,{size:"small",onClick:r=>te(a.row)},{default:o(()=>[l(y,null,{default:o(()=>[l(t(he))]),_:1}),e[16]||(e[16]=s("span",null,"编辑",-1))]),_:1},8,["onClick"]),l(w,{size:"small",type:"danger",onClick:r=>ae(a.row.id)},{default:o(()=>[l(y,null,{default:o(()=>[l(t(J))]),_:1}),e[17]||(e[17]=s("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[pe,t(v)]]),l(re,{"current-page":t(g),"onUpdate:currentPage":e[1]||(e[1]=a=>F(g)?g.value=a:null),"page-size":t(x),"onUpdate:pageSize":e[2]||(e[2]=a=>F(x)?x.value=a:null),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:t(O).length,onSizeChange:W,onCurrentChange:X,style:{"margin-top":"20px","text-align":"right"}},null,8,["current-page","page-size","total"])]),_:1}),l(L,{modelValue:t(A),"onUpdate:modelValue":e[4]||(e[4]=a=>F(A)?A.value=a:null),title:"题目解析",width:"600px"},{footer:o(()=>[s("span",et,[l(w,{onClick:e[3]||(e[3]=a=>A.value=!1)},{default:o(()=>[...e[23]||(e[23]=[h("关闭",-1)])]),_:1})])]),default:o(()=>[s("div",Me,[s("div",Ge,[e[18]||(e[18]=s("span",{class:"explanation-label"},"题目：",-1)),s("span",je,p(t(d).title),1)]),s("div",Je,[e[19]||(e[19]=s("span",{class:"explanation-label"},"类型：",-1)),s("span",Qe,p(t(d).type==="single-choice"?"单选题":t(d).type==="true-false"?"判断题":t(d).type),1)]),t(d).type==="single-choice"?(c(),V("div",Ye,[e[20]||(e[20]=s("span",{class:"explanation-label"},"选项：",-1)),s("div",He,[(c(!0),V(B,null,I(t(d).options,(a,r)=>(c(),V("div",{key:r,class:"explanation-option"},p(String.fromCharCode(65+r))+". "+p(a),1))),128))])])):N("",!0),s("div",Ke,[e[21]||(e[21]=s("span",{class:"explanation-label"},"答案：",-1)),s("span",We,p(t(d).type==="true-false"?t(d).correctAnswer==="正确"?"正确":t(d).correctAnswer==="错误"?"错误":t(d).correctAnswer:t(d).correctAnswer),1)]),s("div",Xe,[e[22]||(e[22]=s("span",{class:"explanation-label"},"解析：",-1)),s("span",Ze,p(t(d).explanation||"暂无解析"),1)])])]),_:1},8,["modelValue"]),l(L,{modelValue:t(_),"onUpdate:modelValue":e[11]||(e[11]=a=>F(_)?_.value=a:null),title:t(D),width:"700px"},{footer:o(()=>[s("span",at,[l(w,{onClick:e[10]||(e[10]=a=>_.value=!1)},{default:o(()=>[...e[26]||(e[26]=[h("取消",-1)])]),_:1}),l(w,{type:"primary",onClick:se},{default:o(()=>[...e[27]||(e[27]=[h("确定",-1)])]),_:1})])]),default:o(()=>[l(q,{model:t(i),rules:H,ref_key:"topicFormRef",ref:b,"label-width":"100px"},{default:o(()=>[l(f,{label:"题目",prop:"title"},{default:o(()=>[l(u,{modelValue:t(i).title,"onUpdate:modelValue":e[5]||(e[5]=a=>t(i).title=a),type:"textarea",rows:3,placeholder:"请输入题目"},null,8,["modelValue"])]),_:1}),l(f,{label:"题目类型",prop:"type"},{default:o(()=>[l(de,{modelValue:t(i).type,"onUpdate:modelValue":e[6]||(e[6]=a=>t(i).type=a),placeholder:"请选择题目类型"},{default:o(()=>[l(M,{label:"单选题",value:"single-choice"}),l(M,{label:"判断题",value:"true-false"})]),_:1},8,["modelValue"])]),_:1}),t(i).type==="single-choice"?(c(),U(f,{key:0,label:"选项",prop:"options"},{default:o(()=>[s("div",tt,[(c(!0),V(B,null,I(t(i).options,(a,r)=>(c(),V("div",{key:r,class:"option-item"},[s("span",lt,p(String.fromCharCode(65+r))+".",1),l(u,{modelValue:t(i).options[r],"onUpdate:modelValue":ce=>t(i).options[r]=ce,placeholder:"请输入选项"+String.fromCharCode(65+r)+"内容",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])]))),128))])]),_:1})):N("",!0),l(f,{label:"答案",prop:"correctAnswer"},{default:o(()=>[t(i).type==="single-choice"?(c(),U(G,{key:0,modelValue:t(i).correctAnswer,"onUpdate:modelValue":e[7]||(e[7]=a=>t(i).correctAnswer=a)},{default:o(()=>[(c(!0),V(B,null,I(t(i).options,(a,r)=>(c(),U(R,{key:r,label:String.fromCharCode(65+r)},{default:o(()=>[h(p(String.fromCharCode(65+r))+". "+p(a),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])):t(i).type==="true-false"?(c(),U(G,{key:1,modelValue:t(i).correctAnswer,"onUpdate:modelValue":e[8]||(e[8]=a=>t(i).correctAnswer=a)},{default:o(()=>[l(R,{label:"正确"},{default:o(()=>[...e[24]||(e[24]=[h("正确",-1)])]),_:1}),l(R,{label:"错误"},{default:o(()=>[...e[25]||(e[25]=[h("错误",-1)])]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),_:1}),l(f,{label:"解析"},{default:o(()=>[l(u,{modelValue:t(i).explanation,"onUpdate:modelValue":e[9]||(e[9]=a=>t(i).explanation=a),type:"textarea",rows:3,placeholder:"请输入解析"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},vt=me(ot,[["__scopeId","data-v-ef9d8d17"]]);export{vt as default};
