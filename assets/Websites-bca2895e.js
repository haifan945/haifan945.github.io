import{_ as G,c as H,o as K,a as y,b as O,e,w as a,u as o,i as Q,r as u,ab as d,E as X,f as Z,d as i,M as ee,D as le,N as te,y as U,a5 as ae,l as W,t as oe,I as ne,J as se,ae as re,V as ue,S as de,n as ie,P as me,T as pe,a6 as _e,q as ce,af as fe,a7 as be,s as ge,W as we,Y as ve}from"./index-dab368ea.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                 *//* empty css                        */import{s as h}from"./request-afa285ff.js";/* empty css                  */import{I as Ve}from"./ImageUpload-91af468e.js";/* empty css                     */function ye(){return h({url:"/websites",method:"get"})}function he(_){return h({url:"/websites",method:"post",data:_})}function F(_,f){return h({url:`/websites/${_}`,method:"put",data:f})}function Ee(_){return h({url:`/websites/${_}`,method:"delete"})}const ke={class:"websites-container"},xe={class:"search-bar"},Ce={class:"action-buttons"},Ue={__name:"Websites",setup(_){const f=u(!1),E=u([]),b=u({name:""}),m=u(!1),k=u(""),x=u(null),w=u(!1),n=u({id:"",name:"",url:"",description:"",logo:"",sort_order:0,is_enabled:!0}),T={name:[{required:!0,message:"请输入网站名称",trigger:"blur"}],url:[{required:!0,message:"请输入网站地址",trigger:"blur"},{type:"url",message:"请输入正确的URL格式",trigger:"blur"}],description:[{required:!0,message:"请输入网站描述",trigger:"blur"}]},I=H(()=>b.value.name?E.value.filter(s=>s.name.includes(b.value.name)):E.value),C=async()=>{f.value=!0;try{const s=await ye();E.value=s||[]}catch{d.error("获取网站列表失败")}finally{f.value=!1}},R=()=>{I.value},S=()=>{w.value=!1,k.value="新建网站",n.value={id:"",name:"",url:"",description:"",icon:"",sort_order:0,is_enabled:!0},m.value=!0},$=s=>{w.value=!0,k.value="编辑网站",n.value={...s},m.value=!0},D=async()=>{x.value&&await x.value.validate(async s=>{if(s)try{w.value?(await F(n.value.id,n.value),d.success("更新成功")):(await he(n.value),d.success("创建成功")),m.value=!1,C()}catch{d.error(w.value?"更新失败":"创建失败")}})},N=s=>{re.confirm("确定要删除该网站吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await Ee(s),d.success("删除成功"),C()}catch{d.error("删除失败")}}).catch(()=>{})},q=async s=>{try{await F(s.id,{is_enabled:s.is_enabled}),d.success("状态更新成功")}catch{d.error("状态更新失败"),s.is_enabled=!s.is_enabled}};return K(()=>{C()}),(s,l)=>{const v=ue,r=de,g=ie,c=me,L=pe,M=_e,p=ce,z=fe,B=be,J=ge,P=X,Y=we,j=Z,A=ve;return y(),O("div",ke,[e(P,{shadow:"hover"},{header:a(()=>[...l[9]||(l[9]=[i("div",{class:"card-header"},[i("span",null,"常用网站管理")],-1)])]),default:a(()=>[i("div",xe,[e(L,{inline:!0,model:o(b)},{default:a(()=>[e(r,{label:"网站名称"},{default:a(()=>[e(v,{modelValue:o(b).name,"onUpdate:modelValue":l[0]||(l[0]=t=>o(b).name=t),placeholder:"请输入网站名称",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(c,{type:"success",onClick:R},{default:a(()=>[e(g,null,{default:a(()=>[e(o(ee))]),_:1}),l[10]||(l[10]=i("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),e(c,{type:"primary",onClick:S},{default:a(()=>[e(g,null,{default:a(()=>[e(o(le))]),_:1}),l[11]||(l[11]=i("span",null,"添加",-1))]),_:1})]),te((y(),U(J,{data:o(I),style:{width:"100%"}},{default:a(()=>[e(p,{label:"Logo",width:"80",align:"center"},{default:a(t=>[t.row.logo&&typeof t.row.logo=="string"&&(t.row.logo.startsWith("/")||t.row.logo.includes("."))?(y(),U(M,{key:0,src:t.row.logo,style:{width:"40px",height:"40px"},fit:"cover"},null,8,["src"])):(y(),U(g,{key:1,size:24},{default:a(()=>[e(o(ae))]),_:1}))]),_:1}),e(p,{prop:"name",label:"网站名称","min-width":"150"}),e(p,{prop:"url",label:"网站地址","min-width":"200"},{default:a(t=>[e(z,{href:t.row.url,target:"_blank",type:"primary"},{default:a(()=>[W(oe(t.row.url),1)]),_:2},1032,["href"])]),_:1}),e(p,{prop:"description",label:"网站描述","min-width":"200"}),e(p,{prop:"sort_order",label:"排序",width:"100",align:"center"}),e(p,{label:"状态",width:"100",align:"center"},{default:a(t=>[e(B,{modelValue:t.row.is_enabled,"onUpdate:modelValue":V=>t.row.is_enabled=V,onChange:V=>q(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(p,{label:"操作",width:"200",fixed:"right",align:"center"},{default:a(t=>[i("div",Ce,[e(c,{size:"small",onClick:V=>$(t.row)},{default:a(()=>[e(g,null,{default:a(()=>[e(o(ne))]),_:1}),l[12]||(l[12]=i("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(c,{size:"small",type:"danger",onClick:V=>N(t.row.id)},{default:a(()=>[e(g,null,{default:a(()=>[e(o(se))]),_:1}),l[13]||(l[13]=i("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[A,o(f)]])]),_:1}),e(j,{modelValue:o(m),"onUpdate:modelValue":l[8]||(l[8]=t=>Q(m)?m.value=t:null),title:o(k),width:"600px"},{footer:a(()=>[e(c,{onClick:l[7]||(l[7]=t=>m.value=!1)},{default:a(()=>[...l[14]||(l[14]=[W("取消",-1)])]),_:1}),e(c,{type:"primary",onClick:D},{default:a(()=>[...l[15]||(l[15]=[W("确定",-1)])]),_:1})]),default:a(()=>[e(L,{model:o(n),rules:T,ref_key:"websiteFormRef",ref:x,"label-width":"100px"},{default:a(()=>[e(r,{label:"网站名称",prop:"name"},{default:a(()=>[e(v,{modelValue:o(n).name,"onUpdate:modelValue":l[1]||(l[1]=t=>o(n).name=t),placeholder:"请输入网站名称"},null,8,["modelValue"])]),_:1}),e(r,{label:"网站地址",prop:"url"},{default:a(()=>[e(v,{modelValue:o(n).url,"onUpdate:modelValue":l[2]||(l[2]=t=>o(n).url=t),placeholder:"请输入网站地址"},null,8,["modelValue"])]),_:1}),e(r,{label:"网站描述",prop:"description"},{default:a(()=>[e(v,{modelValue:o(n).description,"onUpdate:modelValue":l[3]||(l[3]=t=>o(n).description=t),type:"textarea",rows:3,placeholder:"请输入网站描述"},null,8,["modelValue"])]),_:1}),e(r,{label:"网站Logo",prop:"logo"},{default:a(()=>[e(Ve,{modelValue:o(n).logo,"onUpdate:modelValue":l[4]||(l[4]=t=>o(n).logo=t),placeholder:"请输入Logo图片URL","button-text":"上传Logo"},null,8,["modelValue"])]),_:1}),e(r,{label:"排序",prop:"sort_order"},{default:a(()=>[e(Y,{modelValue:o(n).sort_order,"onUpdate:modelValue":l[5]||(l[5]=t=>o(n).sort_order=t),min:0},null,8,["modelValue"])]),_:1}),e(r,{label:"状态",prop:"is_enabled"},{default:a(()=>[e(B,{modelValue:o(n).is_enabled,"onUpdate:modelValue":l[6]||(l[6]=t=>o(n).is_enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Ne=G(Ue,[["__scopeId","data-v-1404238f"]]);export{Ne as default};
