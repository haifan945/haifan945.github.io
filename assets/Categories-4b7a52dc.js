import{_ as ie,c as P,o as ue,a as f,b as C,e,w as a,r as w,E as se,f as re,d as n,u as m,M as R,D,N as L,y as c,x,a5 as E,I as M,J as Q,l as O,V as me,S as pe,n as fe,P as _e,T as ve,a6 as ce,q as ge,a7 as be,s as we,a8 as ye,a9 as Ve,Q as Ce,R as he,W as ke,Y as xe}from"./index-dab368ea.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                 *//* empty css                        */import"./request-afa285ff.js";/* empty css                  *//* empty css                  */import{I as Ee}from"./ImageUpload-91af468e.js";/* empty css                     */import{g as Ue,u as W,d as ze,c as Te}from"./category-b2dc7a1e.js";import{s as G,c as $e}from"./message-f989d8e8.js";const Ie={class:"video-categories-container"},qe={class:"tab-content"},Fe={class:"search-bar"},Se={class:"action-buttons"},Ne={class:"tab-content"},Be={class:"search-bar"},Pe={class:"action-buttons"},Re={class:"tab-content"},De={class:"search-bar"},Le={class:"action-buttons"},Me={class:"tab-content"},Qe={class:"search-bar"},Ge={class:"action-buttons"},Ae={class:"dialog-footer"},Je={__name:"Categories",setup(Oe){const V=w(!1),A=w("新建分类"),g=w(!1),y=w(null),J=w("gesp"),s=w({name:""}),i=w({id:"",name:"",type:"video",description:"",icon:"",image:"",sort_order:0,is_enabled:!0}),Y={name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],type:[{required:!0,message:"请选择分类类型",trigger:"change"}],sort_order:[{required:!0,message:"请输入排序顺序",trigger:"blur"}]},b=w([]),j=P(()=>{let o=b.value.filter(l=>l.type==="video");return s.value.name&&(o=o.filter(l=>{var d;return(d=l.name)==null?void 0:d.includes(s.value.name)})),o.sort((l,d)=>l.sort_order-d.sort_order)}),H=P(()=>{let o=b.value.filter(l=>l.type==="knowledge");return s.value.name&&(o=o.filter(l=>{var d;return(d=l.name)==null?void 0:d.includes(s.value.name)})),o.sort((l,d)=>l.sort_order-d.sort_order)}),K=P(()=>{let o=b.value.filter(l=>l.type==="gesp");return s.value.name&&(o=o.filter(l=>{var d;return(d=l.name)==null?void 0:d.includes(s.value.name)})),o.sort((l,d)=>l.sort_order-d.sort_order)}),X=P(()=>{let o=b.value.filter(l=>l.type==="qceit");return s.value.name&&(o=o.filter(l=>{var d;return(d=l.name)==null?void 0:d.includes(s.value.name)})),o.sort((l,d)=>l.sort_order-d.sort_order)}),Z=async()=>{try{g.value=!0;const o=await Ue();b.value=o||[]}finally{g.value=!1}},ee=o=>{s.value.name=""},U=()=>{console.log("搜索分类:",s.value)},z=()=>{A.value="新建分类",i.value={id:"",name:"",type:J.value,description:"",icon:"",image:"",sort_order:0,is_enabled:!0},y.value&&y.value.clearValidate(),V.value=!0},T=o=>{A.value="编辑分类",i.value={id:o.id,name:o.name,type:o.type||"video",description:o.description||"",icon:o.icon,image:o.image||"",sort_order:o.sort_order,is_enabled:o.is_enabled},y.value&&y.value.clearValidate(),V.value=!0},$=async o=>{try{g.value=!0,await W(o.id,{is_enabled:o.is_enabled}),G("状态更新成功")}finally{g.value=!1}},I=o=>{$e("确定要删除该分类吗？").then(async()=>{try{g.value=!0,await ze(o),b.value=b.value.filter(l=>l.id!==o),G("删除成功")}finally{g.value=!1}}).catch(()=>{})},le=async()=>{y.value&&await y.value.validate(async o=>{if(o)try{if(g.value=!0,i.value.id){const l=await W(i.value.id,i.value),d=b.value.findIndex(v=>v.id===i.value.id);d!==-1&&(b.value[d]=l),G("编辑成功")}else{const l=await Te(i.value);b.value.unshift(l),G("创建成功")}V.value=!1}finally{g.value=!1}})};return ue(()=>{Z()}),(o,l)=>{const d=me,v=pe,r=fe,_=_e,h=ve,q=ce,u=ge,k=be,F=we,S=ye,ae=Ve,te=se,N=Ce,oe=he,ne=ke,de=re,B=xe;return f(),C("div",Ie,[e(te,{shadow:"hover"},{header:a(()=>[...l[14]||(l[14]=[n("div",{class:"card-header"},[n("span",null,"分类管理")],-1)])]),default:a(()=>[e(ae,{modelValue:J.value,"onUpdate:modelValue":l[4]||(l[4]=t=>J.value=t),onTabChange:ee},{default:a(()=>[e(S,{label:"GESP",name:"gesp"},{default:a(()=>[n("div",qe,[n("div",Fe,[e(h,{inline:!0,model:s.value},{default:a(()=>[e(v,{label:"分类名称"},{default:a(()=>[e(d,{modelValue:s.value.name,"onUpdate:modelValue":l[0]||(l[0]=t=>s.value.name=t),placeholder:"请输入分类名称",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(v,null,{default:a(()=>[e(_,{type:"success",onClick:U},{default:a(()=>[e(r,null,{default:a(()=>[e(m(R))]),_:1}),l[15]||(l[15]=n("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),e(_,{type:"primary",onClick:z},{default:a(()=>[e(r,null,{default:a(()=>[e(m(D))]),_:1}),l[16]||(l[16]=n("span",null,"新建分类",-1))]),_:1})]),L((f(),c(F,{data:K.value,style:{width:"100%"}},{default:a(()=>[e(u,{label:"图标",width:"80",align:"center"},{default:a(t=>[t.row.image?(f(),c(q,{key:0,src:t.row.image,style:{width:"40px",height:"40px"},fit:"cover"},null,8,["src"])):t.row.icon?(f(),C("i",{key:1,class:x(t.row.icon),style:{"font-size":"32px",color:"#409eff"}},null,2)):(f(),c(r,{key:2,size:24},{default:a(()=>[e(m(E))]),_:1}))]),_:1}),e(u,{prop:"name",label:"分类名称","min-width":"120"}),e(u,{prop:"description",label:"简介","min-width":"200","show-overflow-tooltip":""}),e(u,{prop:"sort_order",label:"排序",width:"100",align:"center"}),e(u,{label:"状态",width:"100",align:"center"},{default:a(t=>[e(k,{modelValue:t.row.is_enabled,"onUpdate:modelValue":p=>t.row.is_enabled=p,onChange:p=>$(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{label:"操作",width:"200",fixed:"right",align:"center"},{default:a(t=>[n("div",Se,[e(_,{size:"small",onClick:p=>T(t.row)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(M))]),_:1}),l[17]||(l[17]=n("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(_,{size:"small",type:"danger",onClick:p=>I(t.row.id)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(Q))]),_:1}),l[18]||(l[18]=n("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[B,g.value]])])]),_:1}),e(S,{label:"QCEIT",name:"qceit"},{default:a(()=>[n("div",Ne,[n("div",Be,[e(h,{inline:!0,model:s.value},{default:a(()=>[e(v,{label:"分类名称"},{default:a(()=>[e(d,{modelValue:s.value.name,"onUpdate:modelValue":l[1]||(l[1]=t=>s.value.name=t),placeholder:"请输入分类名称",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(v,null,{default:a(()=>[e(_,{type:"success",onClick:U},{default:a(()=>[e(r,null,{default:a(()=>[e(m(R))]),_:1}),l[19]||(l[19]=n("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),e(_,{type:"primary",onClick:z},{default:a(()=>[e(r,null,{default:a(()=>[e(m(D))]),_:1}),l[20]||(l[20]=n("span",null,"新建分类",-1))]),_:1})]),L((f(),c(F,{data:X.value,style:{width:"100%"}},{default:a(()=>[e(u,{label:"图标",width:"80",align:"center"},{default:a(t=>[t.row.image?(f(),c(q,{key:0,src:t.row.image,style:{width:"40px",height:"40px"},fit:"cover"},null,8,["src"])):t.row.icon?(f(),C("i",{key:1,class:x(t.row.icon),style:{"font-size":"32px",color:"#409eff"}},null,2)):(f(),c(r,{key:2,size:24},{default:a(()=>[e(m(E))]),_:1}))]),_:1}),e(u,{prop:"name",label:"分类名称","min-width":"120"}),e(u,{prop:"description",label:"简介","min-width":"200","show-overflow-tooltip":""}),e(u,{prop:"sort_order",label:"排序",width:"100",align:"center"}),e(u,{label:"状态",width:"100",align:"center"},{default:a(t=>[e(k,{modelValue:t.row.is_enabled,"onUpdate:modelValue":p=>t.row.is_enabled=p,onChange:p=>$(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{label:"操作",width:"200",fixed:"right",align:"center"},{default:a(t=>[n("div",Pe,[e(_,{size:"small",onClick:p=>T(t.row)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(M))]),_:1}),l[21]||(l[21]=n("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(_,{size:"small",type:"danger",onClick:p=>I(t.row.id)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(Q))]),_:1}),l[22]||(l[22]=n("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[B,g.value]])])]),_:1}),e(S,{label:"知识库分类",name:"knowledge"},{default:a(()=>[n("div",Re,[n("div",De,[e(h,{inline:!0,model:s.value},{default:a(()=>[e(v,{label:"分类名称"},{default:a(()=>[e(d,{modelValue:s.value.name,"onUpdate:modelValue":l[2]||(l[2]=t=>s.value.name=t),placeholder:"请输入分类名称",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(v,null,{default:a(()=>[e(_,{type:"success",onClick:U},{default:a(()=>[e(r,null,{default:a(()=>[e(m(R))]),_:1}),l[23]||(l[23]=n("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),e(_,{type:"primary",onClick:z},{default:a(()=>[e(r,null,{default:a(()=>[e(m(D))]),_:1}),l[24]||(l[24]=n("span",null,"新建分类",-1))]),_:1})]),L((f(),c(F,{data:H.value,style:{width:"100%"}},{default:a(()=>[e(u,{label:"图标",width:"80",align:"center"},{default:a(t=>[t.row.image?(f(),c(q,{key:0,src:t.row.image,style:{width:"40px",height:"40px"},fit:"cover"},null,8,["src"])):t.row.icon?(f(),C("i",{key:1,class:x(t.row.icon),style:{"font-size":"32px",color:"#409eff"}},null,2)):(f(),c(r,{key:2,size:24},{default:a(()=>[e(m(E))]),_:1}))]),_:1}),e(u,{prop:"name",label:"分类名称","min-width":"120"}),e(u,{prop:"description",label:"简介","min-width":"200","show-overflow-tooltip":""}),e(u,{prop:"sort_order",label:"排序",width:"100",align:"center"}),e(u,{label:"状态",width:"100",align:"center"},{default:a(t=>[e(k,{modelValue:t.row.is_enabled,"onUpdate:modelValue":p=>t.row.is_enabled=p,onChange:p=>$(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{label:"操作",width:"200",fixed:"right",align:"center"},{default:a(t=>[n("div",Le,[e(_,{size:"small",onClick:p=>T(t.row)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(M))]),_:1}),l[25]||(l[25]=n("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(_,{size:"small",type:"danger",onClick:p=>I(t.row.id)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(Q))]),_:1}),l[26]||(l[26]=n("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[B,g.value]])])]),_:1}),e(S,{label:"视频分类",name:"video"},{default:a(()=>[n("div",Me,[n("div",Qe,[e(h,{inline:!0,model:s.value},{default:a(()=>[e(v,{label:"分类名称"},{default:a(()=>[e(d,{modelValue:s.value.name,"onUpdate:modelValue":l[3]||(l[3]=t=>s.value.name=t),placeholder:"请输入分类名称",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(v,null,{default:a(()=>[e(_,{type:"success",onClick:U},{default:a(()=>[e(r,null,{default:a(()=>[e(m(R))]),_:1}),l[27]||(l[27]=n("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),e(_,{type:"primary",onClick:z},{default:a(()=>[e(r,null,{default:a(()=>[e(m(D))]),_:1}),l[28]||(l[28]=n("span",null,"新建分类",-1))]),_:1})]),L((f(),c(F,{data:j.value,style:{width:"100%"}},{default:a(()=>[e(u,{label:"图标",width:"80",align:"center"},{default:a(t=>[t.row.image?(f(),c(q,{key:0,src:t.row.image,style:{width:"40px",height:"40px"},fit:"cover"},null,8,["src"])):t.row.icon?(f(),C("i",{key:1,class:x(t.row.icon),style:{"font-size":"32px",color:"#409eff"}},null,2)):(f(),c(r,{key:2,size:24},{default:a(()=>[e(m(E))]),_:1}))]),_:1}),e(u,{prop:"name",label:"分类名称","min-width":"120"}),e(u,{prop:"description",label:"简介","min-width":"200","show-overflow-tooltip":""}),e(u,{prop:"sort_order",label:"排序",width:"100",align:"center"}),e(u,{label:"状态",width:"100",align:"center"},{default:a(t=>[e(k,{modelValue:t.row.is_enabled,"onUpdate:modelValue":p=>t.row.is_enabled=p,onChange:p=>$(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{label:"操作",width:"200",fixed:"right",align:"center"},{default:a(t=>[n("div",Ge,[e(_,{size:"small",onClick:p=>T(t.row)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(M))]),_:1}),l[29]||(l[29]=n("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(_,{size:"small",type:"danger",onClick:p=>I(t.row.id)},{default:a(()=>[e(r,null,{default:a(()=>[e(m(Q))]),_:1}),l[30]||(l[30]=n("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[B,g.value]])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(de,{modelValue:V.value,"onUpdate:modelValue":l[13]||(l[13]=t=>V.value=t),title:A.value,width:"600px"},{footer:a(()=>[n("span",Ae,[e(_,{onClick:l[12]||(l[12]=t=>V.value=!1)},{default:a(()=>[...l[31]||(l[31]=[O("取消",-1)])]),_:1}),e(_,{type:"primary",onClick:le},{default:a(()=>[...l[32]||(l[32]=[O("确定",-1)])]),_:1})])]),default:a(()=>[e(h,{model:i.value,rules:Y,ref_key:"categoryFormRef",ref:y,"label-width":"100px"},{default:a(()=>[e(v,{label:"分类名称",prop:"name"},{default:a(()=>[e(d,{modelValue:i.value.name,"onUpdate:modelValue":l[5]||(l[5]=t=>i.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),e(v,{label:"分类类型",prop:"type"},{default:a(()=>[e(oe,{modelValue:i.value.type,"onUpdate:modelValue":l[6]||(l[6]=t=>i.value.type=t),placeholder:"请选择分类类型",style:{width:"100%"},disabled:""},{default:a(()=>[e(N,{label:"视频分类",value:"video"}),e(N,{label:"知识库分类",value:"knowledge"}),e(N,{label:"GESP",value:"gesp"}),e(N,{label:"QCEIT",value:"qceit"})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"简介",prop:"description"},{default:a(()=>[e(d,{modelValue:i.value.description,"onUpdate:modelValue":l[7]||(l[7]=t=>i.value.description=t),type:"textarea",rows:3,placeholder:"请输入分类简介"},null,8,["modelValue"])]),_:1}),e(v,{label:"分类图标",prop:"icon"},{default:a(()=>[e(d,{modelValue:i.value.icon,"onUpdate:modelValue":l[8]||(l[8]=t=>i.value.icon=t),placeholder:"请输入 Font Awesome 图标类名，如：fas fa-robot"},{prefix:a(()=>[i.value.icon?(f(),C("i",{key:0,class:x(i.value.icon),style:{color:"#409eff"}},null,2)):(f(),c(r,{key:1},{default:a(()=>[e(m(E))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"分类图片",prop:"image"},{default:a(()=>[e(Ee,{modelValue:i.value.image,"onUpdate:modelValue":l[9]||(l[9]=t=>i.value.image=t),placeholder:"请输入图片URL","button-text":"上传图片"},null,8,["modelValue"])]),_:1}),e(v,{label:"排序顺序",prop:"sort_order"},{default:a(()=>[e(ne,{modelValue:i.value.sort_order,"onUpdate:modelValue":l[10]||(l[10]=t=>i.value.sort_order=t),min:0,max:9999},null,8,["modelValue"])]),_:1}),e(v,{label:"是否启用",prop:"is_enabled"},{default:a(()=>[e(k,{modelValue:i.value.is_enabled,"onUpdate:modelValue":l[11]||(l[11]=t=>i.value.is_enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},dl=ie(Je,[["__scopeId","data-v-70bf8bb2"]]);export{dl as default};
