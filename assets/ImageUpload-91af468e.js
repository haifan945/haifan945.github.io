import{_ as M,c as N,a as p,b as v,d,e as l,u as e,i as O,w as t,G as x,aa as k,O as y,t as j,y as q,r as m,ab as b,V as H,n as $,P as D,ac as G,a6 as T,ad as W}from"./index-dab368ea.js";/* empty css                 */const A={class:"image-upload-container"},J={class:"input-row"},K={key:0,class:"file-info"},Q={class:"file-preview"},X={class:"file-actions"},Y={key:1,class:"upload-progress"},Z={class:"progress-text"},ee={key:2,class:"image-preview"},le={__name:"ImageUpload",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"请输入图片URL"},buttonText:{type:String,default:"上传图片"},uploadUrl:{type:String,default:()=>"https://api.codequiz.com/qiniu/upload"},uploadHeaders:{type:Object,default:()=>({})},maxSize:{type:Number,default:2},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:S}){const h=o,V=S,f=m(null),c=m(!1),_=m(0),i=m(null),u=m(""),n=N({get:()=>h.modelValue,set:a=>V("update:modelValue",a)}),I=(a,s)=>{const U=a.raw.type.startsWith("image/"),r=a.raw.size/1024/1024<h.maxSize;return U?r?(i.value=a.raw,u.value=URL.createObjectURL(a.raw),!1):(b.error(`图片大小不能超过 ${h.maxSize}MB！`),!1):(b.error("只能上传图片文件！"),!1)},z=()=>{i.value&&(c.value=!0,_.value=0,f.value.submit())},R=()=>{u.value&&URL.revokeObjectURL(u.value),i.value=null,u.value="",f.value.clearFiles()},E=a=>{a.percent&&(_.value=Math.round(a.percent))},B=a=>{a.success?(n.value=a.url,b.success("图片上传成功")):b.error(a.error||"图片上传失败"),f.value.clearFiles()},L=()=>{n.value=""};return(a,s)=>{const U=H,r=$,g=D,C=G,w=T,P=W;return p(),v("div",A,[d("div",J,[l(U,{modelValue:e(n),"onUpdate:modelValue":s[0]||(s[0]=F=>O(n)?n.value=F:null),placeholder:o.placeholder,disabled:o.disabled},null,8,["modelValue","placeholder","disabled"]),l(C,{action:o.uploadUrl,headers:o.uploadHeaders,"show-file-list":!1,"on-success":B,"on-change":I,"on-progress":E,accept:"image/*",limit:1,disabled:o.disabled||e(c)||e(i),"auto-upload":!1,ref_key:"uploadRef",ref:f},{default:t(()=>[l(g,{type:"primary",size:"small",disabled:o.disabled||e(c)||e(i)},{default:t(()=>[l(r,null,{default:t(()=>[l(e(x))]),_:1}),s[1]||(s[1]=d("span",null,"选择图片",-1))]),_:1},8,["disabled"])]),_:1},8,["action","headers","disabled"])]),e(i)&&!e(c)?(p(),v("div",K,[d("div",Q,[l(w,{src:e(u),fit:"cover",style:{width:"100px",height:"100px"}},null,8,["src"])]),d("div",X,[l(g,{type:"primary",size:"small",onClick:z},{default:t(()=>[l(r,null,{default:t(()=>[l(e(x))]),_:1}),s[2]||(s[2]=d("span",null,"确认",-1))]),_:1}),l(g,{size:"small",onClick:R},{default:t(()=>[l(r,null,{default:t(()=>[l(e(k))]),_:1}),s[3]||(s[3]=d("span",null,"取消",-1))]),_:1})])])):y("",!0),e(c)?(p(),v("div",Y,[l(P,{percentage:e(_)},null,8,["percentage"]),d("span",Z,j(e(_))+"%",1)])):y("",!0),e(n)?(p(),v("div",ee,[l(w,{src:e(n),"preview-src-list":[e(n)],fit:"cover",style:{width:"100px",height:"100px"}},null,8,["src","preview-src-list"]),o.disabled?y("",!0):(p(),q(g,{key:0,type:"danger",size:"small",circle:"",onClick:L,class:"remove-btn"},{default:t(()=>[l(r,null,{default:t(()=>[l(e(k))]),_:1})]),_:1}))])):y("",!0)])}}},te=M(le,[["__scopeId","data-v-3a8fb843"]]);export{te as I};
