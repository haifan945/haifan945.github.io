import{_ as Q,c as W,o as Y,a as w,b as G,e,w as t,u as n,i as S,r as m,E as H,f as K,d as p,D as X,M as Z,N as ee,y as z,l as P,t as le,I as ae,J as te,O as ne,n as oe,P as se,V as ue,S as re,T as de,q as ie,z as me,s as pe,U as ve,Q as ce,R as fe,Y as _e}from"./index-bc0a5eae.js";/* empty css                   *//* empty css                  *//* empty css                   */import"./request-cb2fba24.js";/* empty css                  *//* empty css                      *//* empty css                 *//* empty css                     */import{g as be,d as he,u as ye,a as ge}from"./user-7078cdab.js";import{I as Ce}from"./ImageUpload-c26cabbc.js";import{c as Ve,s as h}from"./message-4842d644.js";const Ue={class:"users-container"},we={class:"card-header"},Se={class:"action-buttons"},Pe={class:"dialog-footer"},xe={__name:"Users",setup(Ee){const v=m(!1),U=m("新建用户"),y=m(1),g=m(10),c=m(!1),f=m({username:""}),o=m({id:"",username:"",name:"",role:"user",level:"Scratch 一级",password:"",avatar:""}),_=m([]),x=W(()=>{let a=_.value;return f.value.username&&(a=a.filter(l=>{var r,d;return((r=l.username)==null?void 0:r.includes(f.value.username))||((d=l.name)==null?void 0:d.includes(f.value.username))})),a}),I=async()=>{try{c.value=!0;const a=await be();console.log("获取到的用户数据:",a),_.value=a||[]}finally{c.value=!1}};Y(()=>{I()});const T=a=>{g.value=a},B=a=>{y.value=a},D=()=>{U.value="新建用户",o.value={id:"",username:"",password:"",name:"",role:"user",level:"Scratch 一级",avatar:""},v.value=!0},N=a=>{U.value="编辑用户",o.value={id:a.id,username:a.username,name:a.name,role:a.role||"user",level:a.level||"Scratch 一级",avatar:a.avatar||""},v.value=!0},$=a=>{Ve("确定要删除该用户吗？").then(async()=>{try{c.value=!0,await he(a),_.value=_.value.filter(l=>l.id!==a),h("删除成功")}finally{c.value=!1}}).catch(()=>{})},F=()=>{console.log("搜索用户:",f.value)},A=a=>{if(a)return a.startsWith("/static/")?`${"http://192.168.124.11:8000/api".replace("/api","")}${a}`:a},L=async()=>{if(!o.value.username){h("请输入用户名","error");return}if(!o.value.name){h("请输入姓名","error");return}if(!o.value.role){h("请选择角色","error");return}if(!o.value.id&&!o.value.password){h("请输入密码","error");return}try{if(c.value=!0,o.value.id){const a=await ye(o.value.id,o.value),l=_.value.findIndex(r=>r.id===o.value.id);l!==-1&&(_.value[l]=a),h("编辑成功")}else{const a=await ge(o.value);_.value.unshift(a),h("创建成功")}v.value=!1}finally{c.value=!1}};return(a,l)=>{const r=oe,d=se,C=ue,i=re,E=de,b=ie,M=me,R=pe,O=ve,j=H,s=ce,k=fe,q=K,J=_e;return w(),G("div",Ue,[e(j,{shadow:"hover"},{header:t(()=>[p("div",we,[l[12]||(l[12]=p("span",null,"用户管理",-1)),e(d,{type:"primary",onClick:D},{default:t(()=>[e(r,null,{default:t(()=>[e(n(X))]),_:1}),l[11]||(l[11]=p("span",null,"添加",-1))]),_:1})])]),default:t(()=>[e(E,{inline:!0,model:n(f),style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{label:"用户名"},{default:t(()=>[e(C,{modelValue:n(f).username,"onUpdate:modelValue":l[0]||(l[0]=u=>n(f).username=u),placeholder:"请输入用户名",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(d,{type:"primary",onClick:F},{default:t(()=>[e(r,null,{default:t(()=>[e(n(Z))]),_:1}),l[13]||(l[13]=p("span",null,"搜索",-1))]),_:1})]),_:1})]),_:1},8,["model"]),ee((w(),z(R,{data:n(x),style:{width:"100%"}},{default:t(()=>[e(b,{type:"index",label:"序号",width:"100"}),e(b,{label:"头像",width:"100"},{default:t(u=>[e(M,{size:40,src:A(u.row.avatar)},{default:t(()=>{var V;return[P(le((V=u.row.name)==null?void 0:V.charAt(0)),1)]}),_:2},1032,["src"])]),_:1}),e(b,{prop:"username",label:"用户名","min-width":"150"}),e(b,{prop:"name",label:"姓名","min-width":"120"}),e(b,{prop:"level",label:"身份等级","min-width":"120"}),e(b,{prop:"createTime",label:"创建时间","min-width":"180"}),e(b,{label:"操作",width:"180",fixed:"right"},{default:t(u=>[p("div",Se,[e(d,{size:"small",onClick:V=>N(u.row)},{default:t(()=>[e(r,null,{default:t(()=>[e(n(ae))]),_:1}),l[14]||(l[14]=p("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(d,{size:"small",type:"danger",onClick:V=>$(u.row.id)},{default:t(()=>[e(r,null,{default:t(()=>[e(n(te))]),_:1}),l[15]||(l[15]=p("span",null,"删除",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[J,n(c)]]),e(O,{"current-page":n(y),"onUpdate:currentPage":l[1]||(l[1]=u=>S(y)?y.value=u:null),"page-size":n(g),"onUpdate:pageSize":l[2]||(l[2]=u=>S(g)?g.value=u:null),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:n(x).length,onSizeChange:T,onCurrentChange:B,style:{"margin-top":"20px","text-align":"right"}},null,8,["current-page","page-size","total"])]),_:1}),e(q,{modelValue:n(v),"onUpdate:modelValue":l[10]||(l[10]=u=>S(v)?v.value=u:null),title:n(U),width:"600px"},{footer:t(()=>[p("span",Pe,[e(d,{onClick:l[9]||(l[9]=u=>v.value=!1)},{default:t(()=>[...l[16]||(l[16]=[P("取消",-1)])]),_:1}),e(d,{type:"primary",onClick:L},{default:t(()=>[...l[17]||(l[17]=[P("确定",-1)])]),_:1})])]),default:t(()=>[e(E,{model:n(o),"label-width":"100px"},{default:t(()=>[e(i,{label:"用户名"},{default:t(()=>[e(C,{modelValue:n(o).username,"onUpdate:modelValue":l[3]||(l[3]=u=>n(o).username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),n(o).id?ne("",!0):(w(),z(i,{key:0,label:"密码"},{default:t(()=>[e(C,{modelValue:n(o).password,"onUpdate:modelValue":l[4]||(l[4]=u=>n(o).password=u),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})),e(i,{label:"姓名"},{default:t(()=>[e(C,{modelValue:n(o).name,"onUpdate:modelValue":l[5]||(l[5]=u=>n(o).name=u),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(i,{label:"角色"},{default:t(()=>[e(k,{modelValue:n(o).role,"onUpdate:modelValue":l[6]||(l[6]=u=>n(o).role=u),placeholder:"请选择角色"},{default:t(()=>[e(s,{label:"管理员",value:"admin"}),e(s,{label:"教师",value:"teacher"}),e(s,{label:"用户",value:"user"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"身份等级"},{default:t(()=>[e(k,{modelValue:n(o).level,"onUpdate:modelValue":l[7]||(l[7]=u=>n(o).level=u),placeholder:"请选择身份等级"},{default:t(()=>[e(s,{label:"宗师",value:"宗师"}),e(s,{label:"Scratch 一级",value:"Scratch 一级"}),e(s,{label:"Scratch 二级",value:"Scratch 二级"}),e(s,{label:"Scratch 三级",value:"Scratch 三级"}),e(s,{label:"Scratch 四级",value:"Scratch 四级"}),e(s,{label:"Python 一级",value:"Python 一级"}),e(s,{label:"Python 二级",value:"Python 二级"}),e(s,{label:"Python 三级",value:"Python 三级"}),e(s,{label:"Python 四级",value:"Python 四级"}),e(s,{label:"Python 五级",value:"Python 五级"}),e(s,{label:"Python 六级",value:"Python 六级"}),e(s,{label:"Python 七级",value:"Python 七级"}),e(s,{label:"Python 八级",value:"Python 八级"}),e(s,{label:"C++ 一级",value:"C++ 一级"}),e(s,{label:"C++ 二级",value:"C++ 二级"}),e(s,{label:"C++ 三级",value:"C++ 三级"}),e(s,{label:"C++ 四级",value:"C++ 四级"}),e(s,{label:"C++ 五级",value:"C++ 五级"}),e(s,{label:"C++ 六级",value:"C++ 六级"}),e(s,{label:"C++ 七级",value:"C++ 七级"}),e(s,{label:"C++ 八级",value:"C++ 八级"}),e(s,{label:"C++ 九级",value:"C++ 九级"}),e(s,{label:"C++ 十级",value:"C++ 十级"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"头像"},{default:t(()=>[e(Ce,{modelValue:n(o).avatar,"onUpdate:modelValue":l[8]||(l[8]=u=>n(o).avatar=u),placeholder:"请输入头像URL","button-text":"上传头像"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Re=Q(xe,[["__scopeId","data-v-b778c651"]]);export{Re as default};
